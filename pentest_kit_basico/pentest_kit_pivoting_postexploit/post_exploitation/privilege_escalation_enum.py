
import os
import platform
import subprocess

def check_windows_privesc():
    print("[*] Checking Windows Privilege Escalation...")
    print("[*] Current User:")
    os.system("whoami /priv")
    print("[*] Checking for alwaysInstallElevated policy:")
    os.system("reg query HKCU\Software\Policies\Microsoft\Windows\Installer")
    os.system("reg query HKLM\Software\Policies\Microsoft\Windows\Installer")
    print("[*] Checking for service misconfigurations:")
    os.system("sc query")

def check_linux_privesc():
    print("[*] Checking Linux Privilege Escalation...")
    print("[*] Current User:")
    os.system("id")
    print("[*] Checking sudo permissions:")
    os.system("sudo -l")
    print("[*] Finding SUID files:")
    os.system("find / -perm -4000 -type f 2>/dev/null")

if __name__ == "__main__":
    system = platform.system()
    if system == "Windows":
        check_windows_privesc()
    elif system == "Linux":
        check_linux_privesc()
    else:
        print("Unsupported OS")
